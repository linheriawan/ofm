<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Clear Cache - OFM</title>
	<style>
		body {
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 100vh;
			margin: 0;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
		}
		.container {
			background: rgba(255, 255, 255, 0.1);
			backdrop-filter: blur(10px);
			padding: 3rem;
			border-radius: 16px;
			max-width: 500px;
			text-align: center;
		}
		h1 {
			margin: 0 0 1rem 0;
			font-size: 2rem;
		}
		p {
			margin: 0 0 2rem 0;
			line-height: 1.6;
		}
		.btn {
			padding: 1rem 2rem;
			font-size: 1.1rem;
			font-weight: 600;
			background: white;
			color: #667eea;
			border: none;
			border-radius: 8px;
			cursor: pointer;
			transition: transform 0.2s;
		}
		.btn:hover {
			transform: translateY(-2px);
		}
		.status {
			margin-top: 2rem;
			padding: 1rem;
			background: rgba(255, 255, 255, 0.2);
			border-radius: 8px;
			font-family: monospace;
			text-align: left;
			max-height: 300px;
			overflow-y: auto;
		}
		.success {
			color: #10b981;
		}
		.error {
			color: #ef4444;
		}
	</style>
</head>
<body>
	<div class="container">
		<h1>üßπ Clear All Cache</h1>
		<p>This will unregister Service Workers, clear all caches, and reload the page with a fresh start.</p>
		<button class="btn" onclick="clearEverything()">Clear Cache & Reload</button>
		<div id="status" class="status" style="display: none;"></div>
	</div>

	<script>
		async function clearEverything() {
			const statusEl = document.getElementById('status');
			statusEl.style.display = 'block';
			statusEl.innerHTML = '';

			function log(message, type = 'info') {
				const className = type === 'success' ? 'success' : type === 'error' ? 'error' : '';
				statusEl.innerHTML += `<div class="${className}">${message}</div>`;
			}

			try {
				// 1. Unregister all Service Workers
				log('üîÑ Unregistering Service Workers...');
				const registrations = await navigator.serviceWorker.getRegistrations();
				for (const registration of registrations) {
					await registration.unregister();
					log(`‚úì Unregistered: ${registration.scope}`, 'success');
				}

				// 2. Clear all caches
				log('üßπ Clearing all caches...');
				const cacheNames = await caches.keys();
				for (const cacheName of cacheNames) {
					await caches.delete(cacheName);
					log(`‚úì Deleted cache: ${cacheName}`, 'success');
				}

				// 3. Clear localStorage
				log('üßπ Clearing localStorage...');
				localStorage.clear();
				log('‚úì localStorage cleared', 'success');

				// 4. Clear sessionStorage
				log('üßπ Clearing sessionStorage...');
				sessionStorage.clear();
				log('‚úì sessionStorage cleared', 'success');

				log('‚ú® All caches cleared!', 'success');
				log('üîÑ Reloading in 2 seconds...');

				setTimeout(() => {
					window.location.href = '/';
				}, 2000);

			} catch (error) {
				log(`‚ùå Error: ${error.message}`, 'error');
			}
		}
	</script>
</body>
</html>
